1. 编写Java代码

```java
public class HelloJNI {
  // native代表本地方法，所谓的本地方法是指
  // “在Java程序中进行声明，使用C/C++等本地语言来实现”的函数
  native void printHello();
  native void printString(String str);

  // 在linux下，这里写“HelloJNI”将会加载动态库libHelloJNI.so
  static{ System.loadLibrary("HelloJNI"); }

  public static void main(String args[]){
    HelloJNI myJNI = new HelloJNI();
    myJNI.printHello();
    myJNI.printString("Hello World from printString fun");
  }
}
```

2. 编译JAVA代码，生成class文件

```bash
javac HelloJNI.java
```

3. 生成.h文件

```bash
javah HelloJNI
```

生成的.h文件如下所示

```c
/* DO NOT EDIT THIS FILE - it is machine generated */
#include <jni.h>
/* Header for class HelloJNI */

#ifndef _Included_HelloJNI
#define _Included_HelloJNI
#ifdef __cplusplus
extern "C" {
#endif
/*
 * Class:     HelloJNI
 * Method:    printHello
 * Signature: ()V
 */
JNIEXPORT void JNICALL Java_HelloJNI_printHello
  (JNIEnv *, jobject);

/*
 * Class:     HelloJNI
 * Method:    printString
 * Signature: (Ljava/lang/String;)V
 */
JNIEXPORT void JNICALL Java_HelloJNI_printString
  (JNIEnv *, jobject, jstring);

#ifdef __cplusplus
}
#endif
#endif
```

4. 编写C代码

```c
#include "HelloJNI.h"
#include <stdio.h>
JNIEXPORT void JNICALL Java_HelloJNI_printHello(JNIEnv *env, jobject object){
  printf("Hello World!\n");
  return;
}
JNIEXPORT void JNICALL Java_HelloJNI_printString(JNIEnv *env, jobject object, jstring string)
{
 const char *str = (*env)->GetStringUTFChars(env,string,0);
 printf("%s!\n", str);
 (*env)->ReleaseStringUTFChars(env, string, str);
 return;
}
```

5. 生成c共享库

> jni.h头文件存放在jdk的include中
> jni_md.h头文件存放在jdk的include/linux文件夹中


```bash
gcc -I /usr/java/jdk1.8.0_181-amd64/include/ -I /usr/java/jdk1.8.0_181-amd64/include/linux/ -fPIC -shared -o libHelloJNI.so HelloJNI.c
```

6. 将生成的共享库加入到路径中

```bash
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/root/nativeTest
```

7. 运行class文件

```bash
java HelloJNI
```

# 参考文献

https://blog.csdn.net/shensky711/article/details/52806794